/*! cPager  0.1.4 2015-10-17 */
function cPager(a){if(this._page,this._open=0,this._lastopen=0,this._history=[],this._opt={handler:"pageBtn",tmplPath:"tmpl",displayStyle:"block",offButton:"pageBtnOffline",container:"page",start:!1,startTask:!1,startContent:!1,preCache:[]},a)for(var b in a)a.hasOwnProperty(b)&&(this._opt[b]=a[b]);if(this._page=document.getElementById(this._opt.container),!this._page)throw new Error("missing main container #"+this._opt.container);return this.ajaxCache={},this._opt.preCache.length>0&&this._h.cache(this,this._opt.preCache),this._lastopen?this["switch"](this._lastopen):this._opt.start&&this["switch"](this._opt.start,this._opt.startTask,this._opt.startContent),this}cPager.prototype["switch"]=function(a,b,c){return this["switch"].task=this._h.changeContent(null,b,c,a,this),this["switch"].task&&this._h.switchDom(this,a,b,c),this},cPager.prototype.events=function(){for(var a=this,b=function(b){if(this.classList.contains(a._opt.offButton))return!1;var c=this.getAttribute("data-page"),d=this.getAttribute("data-task"),e=this.getAttribute("data-content");if(c||d){if(a._open==c)return!1;a["switch"](c,d,e)}},c=document.getElementsByClassName(this._opt.handler),d=0;d<c.length;d++)c[d].style.curser="pointer",c[d].addEventListener("click",b);return!0},cPager.prototype.getHistory=function(){return this._history?this._history:!1},cPager.prototype.removeHistory=function(a){return a&&!isNaN(a)&&this._history.length>0&&(this._history=this._history.slice(0,this._history.length-a)),!0},cPager.prototype.addHistory=function(a,b,c){if(a){var d={id:a,task:b,content:c};return this._history.push(d),!0}return!1},cPager.prototype._h={changeContent:function(a,b,c,d,e){if("back"==b){var f=2,g=e.getHistory(),h=g[g.length-f];return h?(h.id&&(e["switch"](h.id,h.task,h.content),e.removeHistory(f)),!0):!1}return e._opt.tasks&&e._opt.tasks[b]?e._opt.tasks[b](d,c,a,e._page):!0},switchSuccess:function(a,b,c,d){"function"==typeof a["switch"].task&&a["switch"].task(),a.events(),a.addHistory(b,c,d)},ajaxSuccess:function(a,b,c,d,e){this.switchDom.response=a,e._page.innerHTML=a,e._lastopen=e._open,e._open=b,this.switchSuccess(e,b,c,d)},ajax:function(a,b,c,d,e){var f=this;a.ajaxCache[b]?f.ajaxSuccess(a.ajaxCache[b],c,d,e,a):this.sendRequest(b,function(g){a.ajaxCache[b]=g.responseText,f.ajaxSuccess(g.responseText,c,d,e,a)})},cache:function(a,b){for(var c=0;c<b.length;c++){var d="./"+a._opt.tmplPath+"/"+b[c]+".tpl";this.sendRequest(d,function(b,c){a.ajaxCache[c]=b.responseText})}},switchDom:function(a,b,c,d){return b&&this.ajax(a,"./"+a._opt.tmplPath+"/"+b+".tpl",b,c,d),!1},sendRequest:function(a,b,c){function d(){for(var a=!1,b=0;b<e.length;b++){try{a=e[b]()}catch(c){continue}break}return a}var e=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],f=d();if(f){var g=c?"POST":"GET";f.open(g,a,!0),f.setRequestHeader("User-Agent","XMLHTTP/1.0"),c&&f.setRequestHeader("Content-type","application/x-www-form-urlencoded"),f.onreadystatechange=function(){4==f.readyState&&(200==f.status||304==f.status)&&b(f,a)},4!=f.readyState&&f.send(c)}}};
